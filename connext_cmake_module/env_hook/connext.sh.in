_DEFAULT_NDDSHOME="@Connext_HOME@"
_Connext_LIBRARY_DIR="@Connext_LIBRARY_DIR@"

# Give priority to the NDDSHOME environment variable because the one detected at build time may
# refer to an invalid path, e.g. for users using binaries.

# Warn about changing the Connext location
if [ -n "$NDDSHOME" ] && ["$NDDSHOME" != "$_DEFAULT_NDDSHOME"]; then
  echo "Setting OSPL_HOME to \"$NDDSHOME\" but the one used at build time was \"$_DEFAULT_NDDSHOME\"" 1>&2
fi

if [ -z "$NDDSHOME" ]; then
  echo NDDSHOME environment variable not set.
  echo Using $NDDSHOME that was detected when the workspace was built.
  export NDDSHOME=$_DEFAULT_NDDSHOME
fi

# detect if running on Darwin platform
_UNAME=`uname -s`
_IS_DARWIN=0
if [ "$_UNAME" = "Darwin" ]; then
  _IS_DARWIN=1
fi
unset _UNAME

ament_prepend_unique_value PATH "$_Connext_HOME/bin"

# add the libary dir on the (DY)LD_LIBRARY_PATH for the rtiddsgen tool
ament_prepend_unique_value PATH "$_Connext_LIBRARY_DIR"
if [ $_IS_DARWIN -eq 0 ]; then
  ament_prepend_unique_value LD_LIBRARY_PATH "$_Connext_LIBRARY_DIR"
else
  ament_prepend_unique_value DYLD_LIBRARY_PATH "$_Connext_LIBRARY_DIR"
fi
unset _IS_DARWIN

unset _Connext_LIBRARY_DIR
unset _DEFAULT_NDDSHOME
